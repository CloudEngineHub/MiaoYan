/* ==================== CSS Variables ==================== */
:root {
  /* Brand Colors */
  --primary-color: #1C5D33;
  --primary-light: rgba(28, 93, 51, 0.12);

  /* Base Colors */
  --bg-color: #FFFFFF;
  --text-color: #262626;
  --text-secondary: #777;
  --link-color: #0C6ADA;
  --border-color: #e6e6e6;
  --code-bg: #f7f7f7;
  --diagram-bg: #f7f7f7;
  --blockquote-border-color: #d0d0d0;

  /* Syntax Highlight - Light */
  --hljs-base: #24292e;
  --hljs-comment: #6a737d;
  --hljs-keyword: #d73a49;
  --hljs-string: #032f62;
  --hljs-number: #005cc5;
  --hljs-attribute: #e36209;
  --hljs-title: #6f42c1;

  /* Mermaid Diagram */
  --mermaid-node-bg: #ffffff;
  --mermaid-text-color: #333333;
  --mermaid-border-color: var(--border-color);
  --mermaid-line-color: var(--primary-color);
  --mermaid-edge-label-bg: #ffffff;

  /* Fonts */
  --text-font: 'TsangerJinKai02-W04', -apple-system, BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB, Microsoft YaHei UI, Microsoft YaHei, Arial, sans-serif;

  /* Spacing */
  --border-radius: 6px;
  --border-radius-sm: 4px;
  --border-radius-lg: 8px;

  /* Diagram */
  --markmap-height: 450px;
}

/* ==================== Base Styles ==================== */
html {
  font-size: 15px;
  font-display: block;
  color: var(--text-color);
  font-family: var(--text-font);
  -webkit-font-smoothing: subpixel-antialiased;
  overscroll-behavior: none;
}

body {
  padding: 0;
  margin: 0;
  background: var(--bg-color);
  font-family: var(--text-font);
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
}

img {
  max-width: 100%;
  height: auto;
  object-fit: cover;
}

/* ==================== Typography ==================== */
.heti {
  font-family: var(--text-font);
}

a,
.heti a heti-spacing {
  color: var(--link-color);
}

/* ==================== Code Styles ==================== */
.heti p > code,
.heti li > code,
code {
  font-family: var(--text-font);
  background-color: var(--code-bg);
  padding: 2px 6px;
  border-radius: var(--border-radius-sm);
}

pre {
  font-family: var(--text-font);
  background-color: var(--code-bg);
  padding: 16px;
  border-radius: var(--border-radius);
}

pre code {
  font-family: var(--text-font);
  background-color: var(--code-bg);
}

/* ==================== Tables ==================== */
.heti table,
.heti th,
.heti td {
  border-color: var(--border-color);
  color: var(--text-color);
}

/* ==================== Blockquote ==================== */
.heti blockquote {
  border-left-color: var(--blockquote-border-color);
}

.heti blockquote ol,
.heti blockquote ul {
  margin-block-end: 0.4em !important;
}

.heti blockquote ol,
.heti blockquote ul,
.heti blockquote li {
  line-height: 1.74 !important;
}

/* ==================== HR ==================== */
.heti hr {
  background-color: var(--border-color);
}

/* ==================== Form Elements ==================== */
input[type='checkbox'] {
  border: 1px solid var(--border-color);
}

/* ==================== Diagram Containers ==================== */
.mermaid-image-container,
.markmap-image-container,
.plantuml-image-container,
.plantuml-container,
.plantuml-image,
pre:has(.language-mermaid) {
  background-color: var(--diagram-bg);
}

/* ==================== Dark Mode ==================== */
.darkmode {
  --bg-color: #23282D;
  --text-color: #E7E9EA;
  --text-secondary: #ABB2BF;
  --link-color: #1D9BF0;
  --border-color: #454545;
  --code-bg: #282e33;
  --diagram-bg: #282e33;
  --blockquote-border-color: #545454;

  --mermaid-node-bg: #3c434b;
  --mermaid-text-color: #E7E9EA;
  --mermaid-border-color: #545d68;
  --mermaid-line-color: #1D9BF0;
  --mermaid-edge-label-bg: #282e33;

  --hljs-base: #ABB2BF;
  --hljs-comment: #ABB2BF;
  --hljs-keyword: #9B79F7;
  --hljs-string: #8FFCCD;
  --hljs-number: #F7CC8F;
  --hljs-attribute: #F7CC8F;
  --hljs-title: #99E0FC;
}

.darkmode html,
.darkmode body,
.darkmode * {
  color: var(--text-color);
  background: var(--bg-color);
}

.darkmode a,
.darkmode .heti a heti-spacing {
  color: var(--link-color);
}

.darkmode .heti p > code,
.darkmode .heti li > code,
.darkmode code,
.darkmode .heti table,
.darkmode .heti th,
.darkmode .heti td {
  background-color: var(--code-bg);
  border-color: var(--border-color);
}

.darkmode .heti blockquote {
  border-left-color: var(--blockquote-border-color);
}

.darkmode .heti hr {
  background-color: var(--border-color);
}

.darkmode input[type='checkbox'] {
  border: 1px solid white;
}

.darkmode .mermaid-image-container,
.darkmode .markmap-image-container,
.darkmode .plantuml-image-container,
.darkmode .plantuml-container,
.darkmode .plantuml-image,
.darkmode pre:has(.language-mermaid) {
  background-color: var(--diagram-bg);
}

/* ==================== Code Line Numbers ==================== */
pre code,
.heti pre code {
  background-color: transparent;
}

pre .hljs-ln,
.heti pre .hljs-ln {
  border: none;
  width: 100%;
}

pre .hljs-ln td,
.heti pre .hljs-ln td {
  border: none;
  background: transparent !important;
  padding: 0;
}

pre .hljs-ln tr,
.heti pre .hljs-ln tr,
pre .hljs-ln-line,
.heti pre .hljs-ln-line {
  background: transparent !important;
}

pre .hljs-ln-numbers,
.heti pre .hljs-ln-numbers {
  user-select: none;
  color: var(--border-color);
  opacity: 0.7;
  padding: 0 12px 0 0;
  text-align: right;
}

pre .hljs-ln-code,
.heti pre .hljs-ln-code {
  padding-left: 12px;
}

pre code,
.heti pre code,
pre code.hljs {
  display: block;
  background: transparent !important;
  color: var(--text-color);
}

pre table.hljs-ln,
.heti pre table.hljs-ln {
  width: 100%;
  border: none;
  margin: 0;
  background: transparent;
}

/* ==================== Syntax Highlighting - Light ==================== */
.hljs {
  color: var(--hljs-base);
  background: transparent;
}

.hljs-comment,
.hljs-quote {
  color: var(--hljs-comment);
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-deletion {
  color: var(--hljs-keyword);
}

.hljs-string,
.hljs-addition {
  color: var(--hljs-string);
}

.hljs-number,
.hljs-literal {
  color: var(--hljs-number);
}

.hljs-attribute,
.hljs-variable {
  color: var(--hljs-attribute);
}

.hljs-title,
.hljs-section {
  color: var(--hljs-title);
}

/* ==================== Syntax Highlighting - Dark ==================== */
.darkmode .hljs {
  color: var(--hljs-base);
  background: var(--code-bg) !important;
}

.darkmode .hljs-comment,
.darkmode .hljs-quote {
  color: var(--hljs-comment);
}

.darkmode .hljs-doctag,
.darkmode .hljs-formula,
.darkmode .hljs-keyword {
  color: var(--hljs-keyword);
}

.darkmode .hljs-deletion,
.darkmode .hljs-name,
.darkmode .hljs-section,
.darkmode .hljs-selector-tag,
.darkmode .hljs-subst,
.darkmode .hljs-built_in,
.darkmode .hljs-class .hljs-title,
.darkmode .hljs-title.class_ {
  color: #ED716C;
}

.darkmode .hljs-literal {
  color: #56b6c2;
}

.darkmode .hljs-addition,
.darkmode .hljs-attribute,
.darkmode .hljs-meta .hljs-string,
.darkmode .hljs-regexp,
.darkmode .hljs-string {
  color: var(--hljs-string);
}

.darkmode .hljs-attr,
.darkmode .hljs-number,
.darkmode .hljs-selector-attr,
.darkmode .hljs-selector-class,
.darkmode .hljs-selector-pseudo,
.darkmode .hljs-template-variable,
.darkmode .hljs-type,
.darkmode .hljs-variable {
  color: var(--hljs-number);
}

.darkmode .hljs-bullet,
.darkmode .hljs-link,
.darkmode .hljs-meta,
.darkmode .hljs-selector-id,
.darkmode .hljs-symbol,
.darkmode .hljs-title {
  color: var(--hljs-title);
}

.darkmode .hljs-emphasis {
  font-style: italic;
}

.darkmode .hljs-strong {
  font-weight: 700;
}

.darkmode .hljs-link {
  text-decoration: underline;
}

/* ==================== Mermaid Diagrams ==================== */
.mermaid {
  background-color: var(--diagram-bg) !important;
  color: var(--mermaid-text-color) !important;
}

.mermaid svg {
  background-color: var(--diagram-bg) !important;
}

.darkmode .mermaid {
  background-color: var(--diagram-bg) !important;
  color: var(--text-color) !important;
  padding: 16px;
  border-radius: var(--border-radius);
}

.darkmode .mermaid svg {
  background-color: var(--diagram-bg) !important;
}

.mermaid .label,
.mermaid text,
.mermaid span {
  fill: var(--mermaid-text-color) !important;
  color: var(--mermaid-text-color) !important;
}

.mermaid .node rect,
.mermaid .node circle,
.mermaid .node polygon {
  fill: var(--mermaid-node-bg) !important;
  stroke: var(--mermaid-border-color) !important;
}

.mermaid .cluster rect {
  fill: var(--mermaid-node-bg) !important;
  stroke: var(--mermaid-border-color) !important;
}

.mermaid .cluster text {
  fill: var(--mermaid-text-color) !important;
}

.mermaid .edgePath path,
.mermaid line,
.mermaid polyline {
  stroke: var(--mermaid-line-color) !important;
}

.mermaid .arrowheadPath {
  fill: var(--mermaid-line-color) !important;
}

.mermaid .edgeLabel {
  background-color: var(--mermaid-edge-label-bg) !important;
  color: var(--mermaid-text-color) !important;
  border-radius: var(--border-radius-sm);
  padding: 2px 6px;
}

.mermaid .edgeLabel rect {
  fill: var(--mermaid-edge-label-bg) !important;
  stroke: var(--mermaid-border-color) !important;
}

/* ==================== Emoji Support ==================== */
span.emoji {
  display: -moz-inline-box;
  -moz-box-orient: vertical;
  display: inline-block;
  vertical-align: baseline;
  width: 1em;
  height: 1em;
  background-size: contain;
  background-repeat: no-repeat;
  text-indent: -9999px;
  background-position: 50% 50%;
}

span.emoji-sizer {
  line-height: 0.81em;
  font-size: 1em;
  margin: -2px 0;
}

span.emoji-outer {
  display: -moz-inline-box;
  display: inline-block;
  height: 1em;
  width: 1em;
}

span.emoji-inner {
  display: -moz-inline-box;
  display: inline-block;
  text-indent: -9999px;
  width: 100%;
  height: 100%;
  vertical-align: baseline;
}

img.emoji {
  width: 1em;
  height: 1em;
}

/* ==================== Markmap ==================== */
.language-markmap {
  visibility: hidden !important;
}

.markmap {
  display: block;
  width: 100%;
  height: var(--markmap-height);
  overflow: visible;
}

.markmap svg,
.markmap g,
.markmap circle,
.markmap text {
  cursor: pointer;
}

.markmap svg {
  background: transparent;
}

/* ==================== Images ==================== */
img[loading="lazy"] {
  background-color: #eef1f2;
  outline-color: #eef1f2;
}

#write>img,
#write>p>img,
#write>table>img {
  cursor: zoom-in;
}

img.border {
  border-width: 36px;
  border-style: solid;
  border-image-source: url(https://gw.alipayobjects.com/zos/k/y1/lpOIMY.png);
  border-image-slice: 30;
  border-image-repeat: stretch;
  border-radius: var(--border-radius-lg);
  clip-path: inset(0 round 6px);
}

.markdown-body img,
.markdown-body video {
  border-radius: var(--border-radius-lg);
}

/* ==================== Diagram Containers ==================== */
.mermaid-image-container,
.markmap-image-container,
.plantuml-image-container,
pre:has(.language-mermaid) {
  background: var(--diagram-bg);
  border: none;
  border-radius: var(--border-radius);
  padding: 12px;
  margin: 8px 0;
  box-shadow: none;
}

/* ==================== Media Queries - Dark Mode ==================== */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-color: #23282D;
    --text-color: #E7E9EA;
    --link-color: #1D9BF0;
    --border-color: #454545;
    --code-bg: #282e33;
    --diagram-bg: #282e33;
    --blockquote-border-color: #545454;
  }

  html {
    color: var(--text-color);
  }

  body {
    background: var(--bg-color);
  }

  .heti hr {
    background-color: var(--border-color);
  }

  .heti blockquote {
    border-left-color: var(--blockquote-border-color);
  }

  .heti pre,
  .mermaid-image-container,
  .markmap-image-container,
  .plantuml-image-container,
  pre:has(.language-mermaid) {
    background-color: var(--diagram-bg);
  }

  .heti table,
  .heti th,
  .heti td {
    border-color: var(--border-color);
  }

  .heti p > code,
  .heti li > code {
    background-color: var(--code-bg);
    color: var(--text-color);
  }

  img[loading="lazy"] {
    background-color: var(--code-bg);
    outline-color: var(--code-bg);
  }

  .heti mark {
    background-color: rgba(77, 74, 0, 0.88);
  }

  .heti sup:target,
  .heti sup a:target,
  .heti .heti-fn li:target {
    background-color: #3a6188;
  }

  .heti u[title] {
    border-block-end-color: rgba(255, 255, 255, 0.54);
  }

  .heti .heti-fn {
    border-block-start-color: var(--border-color);
  }
}

/* ==================== Diagram Language Styles ==================== */
.language-mermaid,
.language-markmap,
.language-plantuml {
  border-radius: var(--border-radius);
  overflow: hidden;
}

.language-mermaid svg,
.markmap svg,
.plantuml-image {
  border-radius: var(--border-radius);
}

.mermaid,
.mermaid *,
.markmap,
.markmap *,
.markmap .markmap-node text,
.language-mermaid,
.language-mermaid *,
.language-markmap,
.language-markmap *,
.plantuml-image,
.language-plantuml,
.mermaid text,
.mermaid tspan,
.mermaid foreignObject div,
.mermaid .nodeLabel,
.mermaid .edgeLabel,
.mermaid .label {
  font-family: var(--text-font), -apple-system, BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB, Microsoft YaHei UI, Microsoft YaHei, Arial, sans-serif;
}

/* ==================== Lightense (Image Lightbox) ==================== */
.darkmode .lightense-backdrop {
  background-color: rgba(35, 40, 45, .95) !important;
}

